<h1 id="fibrations-in-agda">Fibrations in agda</h1>
<p>I have recently decided to iron all the kinks of a few proofs left as exercises in Bart Jacobs’ book <em>Categorical logic and type theory</em>, by proving them in agda (and in particular, using <a href="https://github.com/agda/agda-categories">agda-categories</a>).</p>
The first obligatory step is some boilerplate code: let’s keep this to a minimum.
<pre class="Agda"><a id="370" class="Keyword">module</a> <a id="377" href="simple.html" class="Module">simple</a> <a id="384" class="Keyword">where</a>

<a id="391" class="Keyword">open</a> <a id="396" class="Keyword">import</a> <a id="403" href="Categories.Category.Cartesian.Bundle.html" class="Module">Categories.Category.Cartesian.Bundle</a>
<a id="440" class="Keyword">open</a> <a id="445" class="Keyword">import</a> <a id="452" href="Categories.Category.CartesianClosed.Canonical.html" class="Module">Categories.Category.CartesianClosed.Canonical</a>
<a id="498" class="Keyword">open</a> <a id="503" class="Keyword">import</a> <a id="510" href="Categories.Category.Core.html" class="Module">Categories.Category.Core</a>
<a id="535" class="Keyword">open</a> <a id="540" class="Keyword">import</a> <a id="547" href="Data.Product.html" class="Module">Data.Product</a>
<a id="560" class="Keyword">open</a> <a id="565" class="Keyword">import</a> <a id="572" href="Function.html" class="Module">Function</a> <a id="581" class="Keyword">using</a> <a id="587" class="Symbol">(</a><a id="588" href="Function.Base.html#716" class="Function">const</a><a id="593" class="Symbol">)</a>
<a id="595" class="Keyword">open</a> <a id="600" class="Keyword">import</a> <a id="607" href="Level.html" class="Module">Level</a>
<a id="613" class="Keyword">open</a> <a id="618" class="Keyword">import</a> <a id="625" href="Relation.Binary.Core.html" class="Module">Relation.Binary.Core</a> <a id="646" class="Keyword">using</a> <a id="652" class="Symbol">(</a><a id="653" href="Relation.Binary.Core.html#882" class="Function">Rel</a><a id="656" class="Symbol">)</a>
<a id="658" class="Keyword">open</a> <a id="663" class="Keyword">import</a> <a id="670" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
<a id="708" class="Keyword">open</a> <a id="713" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">Relation.Binary.PropositionalEquality.≡-Reasoning</a>

<a id="764" class="Keyword">private</a>
  <a id="774" class="Keyword">variable</a>
    <a id="787" href="simple.html#787" class="Generalizable">a</a> <a id="789" href="simple.html#789" class="Generalizable">b</a> <a id="791" href="simple.html#791" class="Generalizable">c</a> <a id="793" class="Symbol">:</a> <a id="795" href="Agda.Primitive.html#597" class="Postulate">Level</a>

<a id="802" class="Comment">-- I have to redefine function composition. A rename or this will do:</a>
<a id="_⋆_"></a><a id="872" href="simple.html#872" class="Function Operator">_⋆_</a> <a id="876" class="Symbol">:</a> <a id="878" class="Symbol">∀</a> <a id="880" class="Symbol">{</a><a id="881" href="simple.html#881" class="Bound">A</a> <a id="883" class="Symbol">:</a> <a id="885" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="889" href="simple.html#787" class="Generalizable">a</a><a id="890" class="Symbol">}</a> <a id="892" class="Symbol">{</a><a id="893" href="simple.html#893" class="Bound">B</a> <a id="895" class="Symbol">:</a> <a id="897" href="simple.html#881" class="Bound">A</a> <a id="899" class="Symbol">→</a> <a id="901" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="905" href="simple.html#789" class="Generalizable">b</a><a id="906" class="Symbol">}</a> <a id="908" class="Symbol">{</a><a id="909" href="simple.html#909" class="Bound">C</a> <a id="911" class="Symbol">:</a> <a id="913" class="Symbol">{</a><a id="914" href="simple.html#914" class="Bound">x</a> <a id="916" class="Symbol">:</a> <a id="918" href="simple.html#881" class="Bound">A</a><a id="919" class="Symbol">}</a> <a id="921" class="Symbol">→</a> <a id="923" href="simple.html#893" class="Bound">B</a> <a id="925" href="simple.html#914" class="Bound">x</a> <a id="927" class="Symbol">→</a> <a id="929" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="933" href="simple.html#791" class="Generalizable">c</a><a id="934" class="Symbol">}</a> <a id="936" class="Symbol">→</a>
      <a id="944" class="Symbol">(∀</a> <a id="947" class="Symbol">{</a><a id="948" href="simple.html#948" class="Bound">x</a><a id="949" class="Symbol">}</a> <a id="951" class="Symbol">(</a><a id="952" href="simple.html#952" class="Bound">y</a> <a id="954" class="Symbol">:</a> <a id="956" href="simple.html#893" class="Bound">B</a> <a id="958" href="simple.html#948" class="Bound">x</a><a id="959" class="Symbol">)</a> <a id="961" class="Symbol">→</a> <a id="963" href="simple.html#909" class="Bound">C</a> <a id="965" href="simple.html#952" class="Bound">y</a><a id="966" class="Symbol">)</a> <a id="968" class="Symbol">→</a> <a id="970" class="Symbol">(</a><a id="971" href="simple.html#971" class="Bound">g</a> <a id="973" class="Symbol">:</a> <a id="975" class="Symbol">(</a><a id="976" href="simple.html#976" class="Bound">x</a> <a id="978" class="Symbol">:</a> <a id="980" href="simple.html#881" class="Bound">A</a><a id="981" class="Symbol">)</a> <a id="983" class="Symbol">→</a> <a id="985" href="simple.html#893" class="Bound">B</a> <a id="987" href="simple.html#976" class="Bound">x</a><a id="988" class="Symbol">)</a> <a id="990" class="Symbol">→</a>
      <a id="998" class="Symbol">((</a><a id="1000" href="simple.html#1000" class="Bound">x</a> <a id="1002" class="Symbol">:</a> <a id="1004" href="simple.html#881" class="Bound">A</a><a id="1005" class="Symbol">)</a> <a id="1007" class="Symbol">→</a> <a id="1009" href="simple.html#909" class="Bound">C</a> <a id="1011" class="Symbol">(</a><a id="1012" href="simple.html#971" class="Bound">g</a> <a id="1014" href="simple.html#1000" class="Bound">x</a><a id="1015" class="Symbol">))</a>
<a id="1018" href="simple.html#1018" class="Bound">f</a> <a id="1020" href="simple.html#872" class="Function Operator">⋆</a> <a id="1022" href="simple.html#1022" class="Bound">g</a> <a id="1024" class="Symbol">=</a> <a id="1026" class="Symbol">λ</a> <a id="1028" href="simple.html#1028" class="Bound">x</a> <a id="1030" class="Symbol">→</a> <a id="1032" href="simple.html#1018" class="Bound">f</a> <a id="1034" class="Symbol">(</a><a id="1035" href="simple.html#1022" class="Bound">g</a> <a id="1037" href="simple.html#1028" class="Bound">x</a><a id="1038" class="Symbol">)</a>
</pre>
and next, the terminal type, and a lemma that says it has only one term (some proofs of uniqueness require extensionality plus this lemma):
<pre class="Agda"><a id="1188" class="Keyword">data</a> <a id="t"></a><a id="1193" href="simple.html#1193" class="Datatype">t</a> <a id="1195" class="Symbol">:</a> <a id="1197" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1201" class="Keyword">where</a>
 <a id="t.⊤"></a><a id="1208" href="simple.html#1208" class="InductiveConstructor">⊤</a> <a id="1210" class="Symbol">:</a> <a id="1212" href="simple.html#1193" class="Datatype">t</a>

<a id="!-unique-lemma"></a><a id="1215" href="simple.html#1215" class="Function">!-unique-lemma</a> <a id="1230" class="Symbol">:</a> <a id="1232" class="Symbol">∀</a> <a id="1234" class="Symbol">(</a><a id="1235" href="simple.html#1235" class="Bound">x</a> <a id="1237" class="Symbol">:</a> <a id="1239" href="simple.html#1193" class="Datatype">t</a><a id="1240" class="Symbol">)</a> <a id="1242" class="Symbol">→</a> <a id="1244" href="simple.html#1208" class="InductiveConstructor">⊤</a> <a id="1246" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1248" href="simple.html#1235" class="Bound">x</a>
<a id="1250" href="simple.html#1215" class="Function">!-unique-lemma</a> <a id="1265" href="simple.html#1208" class="InductiveConstructor">⊤</a> <a id="1267" class="Symbol">=</a> <a id="1269" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="1275" class="Keyword">postulate</a>
 <a id="1286" class="Comment">-- we need to postulate extensionality...</a>
 <a id="extensionality"></a><a id="1329" href="simple.html#1329" class="Postulate">extensionality</a> <a id="1344" class="Symbol">:</a> <a id="1346" class="Symbol">∀</a> <a id="1348" class="Symbol">{</a><a id="1349" href="simple.html#1349" class="Bound">A</a> <a id="1351" href="simple.html#1351" class="Bound">B</a> <a id="1353" class="Symbol">:</a> <a id="1355" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1358" class="Symbol">}</a> <a id="1360" class="Symbol">{</a><a id="1361" href="simple.html#1361" class="Bound">f</a> <a id="1363" href="simple.html#1363" class="Bound">g</a> <a id="1365" class="Symbol">:</a> <a id="1367" href="simple.html#1349" class="Bound">A</a> <a id="1369" class="Symbol">→</a> <a id="1371" href="simple.html#1351" class="Bound">B</a><a id="1372" class="Symbol">}</a> <a id="1374" class="Symbol">→</a>
  <a id="1378" class="Symbol">(∀</a> <a id="1381" class="Symbol">(</a><a id="1382" href="simple.html#1382" class="Bound">x</a> <a id="1384" class="Symbol">:</a> <a id="1386" href="simple.html#1349" class="Bound">A</a><a id="1387" class="Symbol">)</a> <a id="1389" class="Symbol">→</a> <a id="1391" href="simple.html#1361" class="Bound">f</a> <a id="1393" href="simple.html#1382" class="Bound">x</a> <a id="1395" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1397" href="simple.html#1363" class="Bound">g</a> <a id="1399" href="simple.html#1382" class="Bound">x</a><a id="1400" class="Symbol">)</a> <a id="1402" class="Symbol">→</a> <a id="1404" href="simple.html#1361" class="Bound">f</a> <a id="1406" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1408" href="simple.html#1363" class="Bound">g</a>

<a id="1411" class="Comment">-- and a proof that the category of Sets is indeed a category.</a>
<a id="SetC"></a><a id="1474" href="simple.html#1474" class="Function">SetC</a> <a id="1479" class="Symbol">:</a> <a id="1481" href="Categories.Category.Core.html#442" class="Record">Category</a> <a id="1490" class="Symbol">(</a><a id="1491" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="1495" href="Agda.Primitive.html#764" class="Primitive">zero</a><a id="1499" class="Symbol">)</a> <a id="1501" href="Agda.Primitive.html#764" class="Primitive">zero</a> <a id="1506" href="Agda.Primitive.html#764" class="Primitive">zero</a>
<a id="1511" class="Comment">-- a category depends on three levels:</a>
<a id="1550" class="Comment">-- 1. where the objects live,</a>
<a id="1580" class="Comment">-- 2. where the hom-set(oid)s live,</a>
<a id="1616" class="Comment">-- 3. and where the category lives.</a>
<a id="1652" href="simple.html#1474" class="Function">SetC</a> <a id="1657" class="Symbol">=</a>
 <a id="1660" class="Keyword">record</a>
  <a id="1669" class="Symbol">{</a> <a id="1671" href="Categories.Category.Core.html#559" class="Field">Obj</a> <a id="1675" class="Symbol">=</a> <a id="1677" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="1683" class="Comment">-- the class of objects</a>
  <a id="1709" class="Symbol">;</a> <a id="1711" href="Categories.Category.Core.html#575" class="Field Operator">_⇒_</a> <a id="1715" class="Symbol">=</a> <a id="1717" class="Symbol">λ</a> <a id="1719" href="simple.html#1719" class="Bound">x</a> <a id="1721" href="simple.html#1721" class="Bound">y</a> <a id="1723" class="Symbol">→</a> <a id="1725" href="simple.html#1719" class="Bound">x</a> <a id="1727" class="Symbol">→</a> <a id="1729" href="simple.html#1721" class="Bound">y</a>
  <a id="1733" class="Comment">-- the relation defining the hom-setoids.</a>
  <a id="1777" class="Symbol">;</a> <a id="1779" href="Categories.Category.Core.html#595" class="Field Operator">_≈_</a> <a id="1783" class="Symbol">=</a> <a id="1785" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a>
  <a id="1791" class="Comment">-- def of equality in the homs</a>
  <a id="1824" class="Symbol">;</a> <a id="1826" href="Categories.Category.Core.html#630" class="Field">id</a> <a id="1829" class="Symbol">=</a> <a id="1831" class="Symbol">λ</a> <a id="1833" href="simple.html#1833" class="Bound">x</a> <a id="1835" class="Symbol">→</a> <a id="1837" href="simple.html#1833" class="Bound">x</a>
  <a id="1841" class="Comment">-- the identity function</a>
  <a id="1868" class="Symbol">;</a> <a id="1870" href="Categories.Category.Core.html#656" class="Field Operator">_∘_</a> <a id="1874" class="Symbol">=</a> <a id="1876" class="Symbol">λ</a> <a id="1878" href="simple.html#1878" class="Bound">f</a> <a id="1880" href="simple.html#1880" class="Bound">g</a> <a id="1882" href="simple.html#1882" class="Bound">a</a> <a id="1884" class="Symbol">→</a> <a id="1886" href="simple.html#1878" class="Bound">f</a> <a id="1888" class="Symbol">(</a><a id="1889" href="simple.html#1880" class="Bound">g</a> <a id="1891" href="simple.html#1882" class="Bound">a</a><a id="1892" class="Symbol">)</a>
  <a id="1896" class="Comment">-- category composition</a>
  <a id="1922" class="Symbol">;</a> <a id="1924" href="Categories.Category.Core.html#715" class="Field">assoc</a> <a id="1930" class="Symbol">=</a> <a id="1932" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="1939" class="Symbol">;</a> <a id="1941" href="Categories.Category.Core.html#1004" class="Field">sym-assoc</a> <a id="1951" class="Symbol">=</a> <a id="1953" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="1960" class="Comment">-- two proofs of associativity: this makes (C^op)^op</a>
  <a id="2015" class="Comment">-- syntactically equal to C, which is nice</a>
  <a id="2060" class="Symbol">;</a> <a id="2062" href="Categories.Category.Core.html#1096" class="Field">identityˡ</a> <a id="2072" class="Symbol">=</a> <a id="2074" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="2081" class="Symbol">;</a> <a id="2083" href="Categories.Category.Core.html#1145" class="Field">identityʳ</a> <a id="2093" class="Symbol">=</a> <a id="2095" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="2102" class="Symbol">;</a> <a id="2104" href="Categories.Category.Core.html#1339" class="Field">identity²</a> <a id="2114" class="Symbol">=</a> <a id="2116" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="2123" class="Comment">-- proofs that id . f = f = f . id and id . id = id</a>
  <a id="2177" class="Symbol">;</a> <a id="2179" href="Categories.Category.Core.html#1384" class="Field">equiv</a> <a id="2185" class="Symbol">=</a> <a id="2187" class="Keyword">record</a> <a id="2194" class="Symbol">{</a> <a id="2196" href="Relation.Binary.Structures.html#1568" class="Field">refl</a> <a id="2201" class="Symbol">=</a> <a id="2203" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="2208" class="Symbol">;</a> <a id="2210" href="Relation.Binary.Structures.html#1594" class="Field">sym</a> <a id="2214" class="Symbol">=</a> <a id="2216" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="2220" class="Symbol">;</a> <a id="2222" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="2228" class="Symbol">=</a> <a id="2230" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a> <a id="2236" class="Symbol">}</a>
  <a id="2240" class="Comment">-- proof that _≈_ is an equivalence relation...</a>
  <a id="2290" class="Symbol">;</a> <a id="2292" href="Categories.Category.Core.html#1438" class="Field">∘-resp-≈</a> <a id="2301" class="Symbol">=</a> <a id="2303" class="Symbol">λ</a> <a id="2305" class="Symbol">{</a><a id="2306" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="2311" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="2316" class="Symbol">→</a> <a id="2318" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2322" class="Symbol">}</a>
  <a id="2326" class="Comment">-- and a congruence with respect to composition.</a>
  <a id="2377" class="Symbol">}</a>
</pre>
<p>Everything is quite trivial here; the comments I added clarify how the various records have to be filled. Probably one of the most useful tricks to learn here, is the way in which the last field was filled: I didn’t know about the existence of this when I first opened this file, and it really saved me hours.</p>
<p>Now, one of the first interesting examples in Jacobs’ book is that of a <em>simple fibration</em> over a category 𝔹 with finite products (let’s say, all finite limits, and for fibration-theory purposes, even a <em>canonical</em> choice thereof).</p>
<p>Given such a category 𝔹, the category s(𝔹) is defined having</p>
<ol type="1">
<li>objects the pairs <code>(I , X)</code> of objects in 𝔹;</li>
<li>morphisms <code>(I , X) → (J , Y)</code> are pairs of morphisms <code>u : I → J</code> and <code>f : I × X → Y</code>.</li>
</ol>
<p>The identity is the “trivial” pair made by the couple <code>(id {I} , proj₂)</code> (the projection on the second factor). The composition of <code>(u , f)</code> and <code>(v , g)</code> is defined as <code>(v ∘ u , g ∘ ⟨ u ∘ proj₁ , f ⟩)</code>, and all the other choices are either forced by this, or straightforward (for example, <code>_≈_</code> is just <code>_≡_</code>).</p>
Fortunately, agda needs just a little bit of help to figure everything out.
<pre class="Agda"><a id="simple"></a><a id="3520" href="simple.html#3520" class="Function">simple</a> <a id="3527" class="Symbol">:</a> <a id="3529" href="Categories.Category.Core.html#442" class="Record">Category</a> <a id="3538" class="Symbol">(</a><a id="3539" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="3543" href="Agda.Primitive.html#764" class="Primitive">zero</a><a id="3547" class="Symbol">)</a> <a id="3549" href="Agda.Primitive.html#764" class="Primitive">zero</a> <a id="3554" href="Agda.Primitive.html#764" class="Primitive">zero</a>
<a id="3559" href="simple.html#3520" class="Function">simple</a> <a id="3566" class="Symbol">=</a>
 <a id="3569" class="Keyword">record</a>
  <a id="3578" class="Comment">-- structure</a>
  <a id="3593" class="Symbol">{</a> <a id="3595" href="Categories.Category.Core.html#559" class="Field">Obj</a> <a id="3599" class="Symbol">=</a> <a id="3601" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="3605" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3607" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="3613" class="Symbol">;</a> <a id="3615" href="Categories.Category.Core.html#575" class="Field Operator">_⇒_</a> <a id="3619" class="Symbol">=</a> <a id="3621" href="simple.html#3942" class="Function Operator">_⇒_</a>
  <a id="3627" class="Symbol">;</a> <a id="3629" href="Categories.Category.Core.html#595" class="Field Operator">_≈_</a> <a id="3633" class="Symbol">=</a> <a id="3635" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a>
  <a id="3641" class="Symbol">;</a> <a id="3643" href="Categories.Category.Core.html#630" class="Field">id</a> <a id="3646" class="Symbol">=</a> <a id="3648" class="Symbol">(λ</a> <a id="3651" href="simple.html#3651" class="Bound">z</a> <a id="3653" class="Symbol">→</a> <a id="3655" href="simple.html#3651" class="Bound">z</a><a id="3656" class="Symbol">)</a> <a id="3658" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3660" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a>
  <a id="3668" class="Symbol">;</a> <a id="3670" href="Categories.Category.Core.html#656" class="Field Operator">_∘_</a> <a id="3674" class="Symbol">=</a> <a id="3676" href="simple.html#4015" class="Function Operator">_∘_</a>
  <a id="3682" class="Comment">-- properties</a>
  <a id="3698" class="Symbol">;</a> <a id="3700" href="Categories.Category.Core.html#715" class="Field">assoc</a> <a id="3706" class="Symbol">=</a> <a id="3708" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="3715" class="Symbol">;</a> <a id="3717" href="Categories.Category.Core.html#1004" class="Field">sym-assoc</a> <a id="3727" class="Symbol">=</a> <a id="3729" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="3736" class="Symbol">;</a> <a id="3738" href="Categories.Category.Core.html#1096" class="Field">identityˡ</a> <a id="3748" class="Symbol">=</a> <a id="3750" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="3757" class="Symbol">;</a> <a id="3759" href="Categories.Category.Core.html#1145" class="Field">identityʳ</a> <a id="3769" class="Symbol">=</a> <a id="3771" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="3778" class="Symbol">;</a> <a id="3780" href="Categories.Category.Core.html#1339" class="Field">identity²</a> <a id="3790" class="Symbol">=</a> <a id="3792" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="3799" class="Comment">-- whew, they&#39;re all trivial!</a>
  <a id="3831" class="Symbol">;</a> <a id="3833" href="Categories.Category.Core.html#1384" class="Field">equiv</a> <a id="3839" class="Symbol">=</a> <a id="3841" class="Keyword">record</a> <a id="3848" class="Symbol">{</a> <a id="3850" href="Relation.Binary.Structures.html#1568" class="Field">refl</a> <a id="3855" class="Symbol">=</a> <a id="3857" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="3862" class="Symbol">;</a> <a id="3864" href="Relation.Binary.Structures.html#1594" class="Field">sym</a> <a id="3868" class="Symbol">=</a> <a id="3870" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="3874" class="Symbol">;</a> <a id="3876" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="3882" class="Symbol">=</a> <a id="3884" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a> <a id="3890" class="Symbol">}</a>
  <a id="3894" class="Symbol">;</a> <a id="3896" href="Categories.Category.Core.html#1438" class="Field">∘-resp-≈</a> <a id="3905" class="Symbol">=</a> <a id="3907" class="Symbol">λ</a> <a id="3909" class="Symbol">{</a><a id="3910" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="3915" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="3920" class="Symbol">→</a> <a id="3922" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="3926" class="Symbol">}</a>
  <a id="3930" class="Symbol">}</a>
  <a id="3934" class="Keyword">where</a>
  <a id="3942" href="simple.html#3942" class="Function Operator">_⇒_</a> <a id="3946" class="Symbol">:</a> <a id="3948" href="Relation.Binary.Core.html#882" class="Function">Rel</a> <a id="3952" class="Symbol">(</a><a id="3953" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="3957" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3959" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="3962" class="Symbol">)</a> <a id="3964" href="Agda.Primitive.html#764" class="Primitive">zero</a>
  <a id="3971" class="Symbol">(</a><a id="3972" href="simple.html#3972" class="Bound">i</a> <a id="3974" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3976" href="simple.html#3976" class="Bound">x</a><a id="3977" class="Symbol">)</a> <a id="3979" href="simple.html#3942" class="Function Operator">⇒</a> <a id="3981" class="Symbol">(</a><a id="3982" href="simple.html#3982" class="Bound">j</a> <a id="3984" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3986" href="simple.html#3986" class="Bound">y</a><a id="3987" class="Symbol">)</a> <a id="3989" class="Symbol">=</a> <a id="3991" class="Symbol">(</a><a id="3992" href="simple.html#3972" class="Bound">i</a> <a id="3994" class="Symbol">→</a> <a id="3996" href="simple.html#3982" class="Bound">j</a><a id="3997" class="Symbol">)</a> <a id="3999" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4001" class="Symbol">(</a><a id="4002" href="simple.html#3976" class="Bound">x</a> <a id="4004" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4006" href="simple.html#3972" class="Bound">i</a> <a id="4008" class="Symbol">→</a> <a id="4010" href="simple.html#3986" class="Bound">y</a><a id="4011" class="Symbol">)</a>
  <a id="4015" href="simple.html#4015" class="Function Operator">_∘_</a> <a id="4019" class="Symbol">:</a> <a id="4021" class="Symbol">{</a><a id="4022" href="simple.html#4022" class="Bound">A</a> <a id="4024" href="simple.html#4024" class="Bound">B</a> <a id="4026" href="simple.html#4026" class="Bound">C</a> <a id="4028" class="Symbol">:</a> <a id="4030" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="4034" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4036" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="4039" class="Symbol">}</a> <a id="4041" class="Symbol">→</a> <a id="4043" href="simple.html#4024" class="Bound">B</a> <a id="4045" href="simple.html#3942" class="Function Operator">⇒</a> <a id="4047" href="simple.html#4026" class="Bound">C</a> <a id="4049" class="Symbol">→</a> <a id="4051" href="simple.html#4022" class="Bound">A</a> <a id="4053" href="simple.html#3942" class="Function Operator">⇒</a> <a id="4055" href="simple.html#4024" class="Bound">B</a> <a id="4057" class="Symbol">→</a> <a id="4059" href="simple.html#4022" class="Bound">A</a> <a id="4061" href="simple.html#3942" class="Function Operator">⇒</a> <a id="4063" href="simple.html#4026" class="Bound">C</a>
  <a id="4067" href="simple.html#4015" class="Function Operator">_∘_</a> <a id="4071" class="Symbol">{</a><a id="4072" href="simple.html#4072" class="Bound">i</a> <a id="4074" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4076" href="simple.html#4076" class="Bound">x</a><a id="4077" class="Symbol">}</a> <a id="4079" class="Symbol">{</a><a id="4080" href="simple.html#4080" class="Bound">j</a> <a id="4082" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4084" href="simple.html#4084" class="Bound">y</a><a id="4085" class="Symbol">}</a> <a id="4087" class="Symbol">{_}</a> <a id="4091" class="Symbol">(</a><a id="4092" href="simple.html#4092" class="Bound">u</a> <a id="4094" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4096" href="simple.html#4096" class="Bound">f</a><a id="4097" class="Symbol">)</a> <a id="4099" class="Symbol">(</a><a id="4100" href="simple.html#4100" class="Bound">v</a> <a id="4102" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4104" href="simple.html#4104" class="Bound">g</a><a id="4105" class="Symbol">)</a> <a id="4107" class="Symbol">=</a>
   <a id="4112" class="Symbol">(λ</a> <a id="4115" href="simple.html#4115" class="Bound">t</a> <a id="4117" class="Symbol">→</a> <a id="4119" href="simple.html#4092" class="Bound">u</a> <a id="4121" class="Symbol">(</a><a id="4122" href="simple.html#4100" class="Bound">v</a> <a id="4124" href="simple.html#4115" class="Bound">t</a><a id="4125" class="Symbol">))</a> <a id="4128" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4130" class="Symbol">λ</a> <a id="4132" href="simple.html#4132" class="Bound">t</a> <a id="4134" class="Symbol">→</a> <a id="4136" href="simple.html#4096" class="Bound">f</a> <a id="4138" class="Symbol">(</a><a id="4139" href="simple.html#4104" class="Bound">g</a> <a id="4141" href="simple.html#4132" class="Bound">t</a> <a id="4143" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4145" href="simple.html#4100" class="Bound">v</a> <a id="4147" class="Symbol">(</a><a id="4148" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="4154" href="simple.html#4132" class="Bound">t</a><a id="4155" class="Symbol">))</a>
</pre>
Now, <code>s(𝔹)</code> comes equipped with an obvious forgetful functor to 𝔹, projecting on the first component: the object of interest for Jacobs’ is the fiber of this functor over a certain <code>I ∈ 𝔹</code>. Such a category can be characterised in many ways; the most elegant is: it is a certain Kleisli category.
<pre class="Agda"><a id="fiber-of-simple"></a><a id="4462" href="simple.html#4462" class="Function">fiber-of-simple</a> <a id="4478" class="Symbol">:</a> <a id="4480" class="Symbol">{</a><a id="4481" href="simple.html#4481" class="Bound">I</a> <a id="4483" class="Symbol">:</a> <a id="4485" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="4488" class="Symbol">}</a> <a id="4490" class="Symbol">→</a> <a id="4492" href="Categories.Category.Core.html#442" class="Record">Category</a> <a id="4501" class="Symbol">(</a><a id="4502" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="4506" href="Agda.Primitive.html#764" class="Primitive">zero</a><a id="4510" class="Symbol">)</a> <a id="4512" href="Agda.Primitive.html#764" class="Primitive">zero</a> <a id="4517" href="Agda.Primitive.html#764" class="Primitive">zero</a>
<a id="4522" href="simple.html#4462" class="Function">fiber-of-simple</a> <a id="4538" class="Symbol">{</a><a id="4539" href="simple.html#4539" class="Bound">I</a><a id="4540" class="Symbol">}</a> <a id="4542" class="Symbol">=</a>
 <a id="4545" class="Keyword">record</a>
  <a id="4554" class="Symbol">{</a> <a id="4556" href="Categories.Category.Core.html#559" class="Field">Obj</a> <a id="4560" class="Symbol">=</a> <a id="4562" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="4568" class="Symbol">;</a> <a id="4570" href="Categories.Category.Core.html#575" class="Field Operator">_⇒_</a> <a id="4574" class="Symbol">=</a> <a id="4576" class="Symbol">λ</a> <a id="4578" href="simple.html#4578" class="Bound">X</a> <a id="4580" href="simple.html#4580" class="Bound">Y</a> <a id="4582" class="Symbol">→</a> <a id="4584" href="simple.html#4578" class="Bound">X</a> <a id="4586" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4588" href="simple.html#4539" class="Bound">I</a> <a id="4590" class="Symbol">→</a> <a id="4592" href="simple.html#4580" class="Bound">Y</a>
  <a id="4596" class="Symbol">;</a> <a id="4598" href="Categories.Category.Core.html#595" class="Field Operator">_≈_</a> <a id="4602" class="Symbol">=</a> <a id="4604" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a>
  <a id="4610" class="Symbol">;</a> <a id="4612" href="Categories.Category.Core.html#630" class="Field">id</a> <a id="4615" class="Symbol">=</a> <a id="4617" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a>
  <a id="4625" class="Symbol">;</a> <a id="4627" href="Categories.Category.Core.html#656" class="Field Operator">_∘_</a> <a id="4631" class="Symbol">=</a> <a id="4633" href="simple.html#4872" class="Function Operator">_·_</a> <a id="4637" class="Comment">-- this is the Kleisli composition</a>
  <a id="4674" class="Symbol">;</a> <a id="4676" href="Categories.Category.Core.html#715" class="Field">assoc</a> <a id="4682" class="Symbol">=</a> <a id="4684" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="4691" class="Symbol">;</a> <a id="4693" href="Categories.Category.Core.html#1004" class="Field">sym-assoc</a> <a id="4703" class="Symbol">=</a> <a id="4705" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="4712" class="Symbol">;</a> <a id="4714" href="Categories.Category.Core.html#1096" class="Field">identityˡ</a> <a id="4724" class="Symbol">=</a> <a id="4726" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="4733" class="Symbol">;</a> <a id="4735" href="Categories.Category.Core.html#1145" class="Field">identityʳ</a> <a id="4745" class="Symbol">=</a> <a id="4747" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="4754" class="Symbol">;</a> <a id="4756" href="Categories.Category.Core.html#1339" class="Field">identity²</a> <a id="4766" class="Symbol">=</a> <a id="4768" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="4775" class="Symbol">;</a> <a id="4777" href="Categories.Category.Core.html#1384" class="Field">equiv</a> <a id="4783" class="Symbol">=</a> <a id="4785" class="Keyword">record</a> <a id="4792" class="Symbol">{</a> <a id="4794" href="Relation.Binary.Structures.html#1568" class="Field">refl</a> <a id="4799" class="Symbol">=</a> <a id="4801" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="4806" class="Symbol">;</a> <a id="4808" href="Relation.Binary.Structures.html#1594" class="Field">sym</a> <a id="4812" class="Symbol">=</a> <a id="4814" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="4818" class="Symbol">;</a> <a id="4820" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="4826" class="Symbol">=</a> <a id="4828" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a> <a id="4834" class="Symbol">}</a>
  <a id="4838" class="Symbol">;</a> <a id="4840" href="Categories.Category.Core.html#1438" class="Field">∘-resp-≈</a> <a id="4849" class="Symbol">=</a> <a id="4851" href="simple.html#4987" class="Function">rresp</a>
  <a id="4859" class="Symbol">}</a>
  <a id="4863" class="Keyword">where</a>
   <a id="4872" href="simple.html#4872" class="Function Operator">_·_</a> <a id="4876" class="Symbol">:</a> <a id="4878" class="Symbol">{</a><a id="4879" href="simple.html#4879" class="Bound">I</a> <a id="4881" class="Symbol">:</a> <a id="4883" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="4886" class="Symbol">}</a> <a id="4888" class="Symbol">{</a><a id="4889" href="simple.html#4889" class="Bound">A</a> <a id="4891" href="simple.html#4891" class="Bound">B</a> <a id="4893" href="simple.html#4893" class="Bound">C</a> <a id="4895" class="Symbol">:</a> <a id="4897" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="4900" class="Symbol">}</a> <a id="4902" class="Symbol">→</a> <a id="4904" class="Symbol">(</a><a id="4905" href="simple.html#4891" class="Bound">B</a> <a id="4907" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4909" href="simple.html#4879" class="Bound">I</a> <a id="4911" class="Symbol">→</a> <a id="4913" href="simple.html#4893" class="Bound">C</a><a id="4914" class="Symbol">)</a> <a id="4916" class="Symbol">→</a> <a id="4918" class="Symbol">(</a><a id="4919" href="simple.html#4889" class="Bound">A</a> <a id="4921" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4923" href="simple.html#4879" class="Bound">I</a> <a id="4925" class="Symbol">→</a> <a id="4927" href="simple.html#4891" class="Bound">B</a><a id="4928" class="Symbol">)</a> <a id="4930" class="Symbol">→</a> <a id="4932" href="simple.html#4889" class="Bound">A</a> <a id="4934" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4936" href="simple.html#4879" class="Bound">I</a> <a id="4938" class="Symbol">→</a> <a id="4940" href="simple.html#4893" class="Bound">C</a>
   <a id="4945" href="simple.html#4872" class="Function Operator">_·_</a> <a id="4949" class="Symbol">{</a><a id="4950" href="simple.html#4950" class="Bound">I</a><a id="4951" class="Symbol">}</a> <a id="4953" href="simple.html#4953" class="Bound">f</a> <a id="4955" href="simple.html#4955" class="Bound">g</a> <a id="4957" class="Symbol">(</a><a id="4958" href="simple.html#4958" class="Bound">x</a> <a id="4960" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4962" href="simple.html#4962" class="Bound">i</a><a id="4963" class="Symbol">)</a> <a id="4965" class="Symbol">=</a> <a id="4967" href="simple.html#4953" class="Bound">f</a> <a id="4969" class="Symbol">(</a><a id="4970" href="simple.html#4955" class="Bound">g</a><a id="4971" class="Symbol">(</a><a id="4972" href="simple.html#4958" class="Bound">x</a> <a id="4974" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4976" href="simple.html#4962" class="Bound">i</a><a id="4977" class="Symbol">)</a> <a id="4979" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4981" href="simple.html#4962" class="Bound">i</a><a id="4982" class="Symbol">)</a>
   <a id="4987" href="simple.html#4987" class="Function">rresp</a> <a id="4993" class="Symbol">:</a> <a id="4995" class="Symbol">{</a><a id="4996" href="simple.html#4996" class="Bound">A</a> <a id="4998" href="simple.html#4998" class="Bound">B</a> <a id="5000" href="simple.html#5000" class="Bound">C</a> <a id="5002" class="Symbol">:</a> <a id="5004" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="5007" class="Symbol">}</a> <a id="5009" class="Symbol">{</a><a id="5010" href="simple.html#5010" class="Bound">f</a> <a id="5012" href="simple.html#5012" class="Bound">h</a> <a id="5014" class="Symbol">:</a> <a id="5016" href="simple.html#4998" class="Bound">B</a> <a id="5018" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5020" href="simple.html#4539" class="Bound">I</a> <a id="5022" class="Symbol">→</a> <a id="5024" href="simple.html#5000" class="Bound">C</a><a id="5025" class="Symbol">}</a> <a id="5027" class="Symbol">{</a><a id="5028" href="simple.html#5028" class="Bound">g</a> <a id="5030" href="simple.html#5030" class="Bound">i</a> <a id="5032" class="Symbol">:</a> <a id="5034" href="simple.html#4996" class="Bound">A</a> <a id="5036" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5038" href="simple.html#4539" class="Bound">I</a> <a id="5040" class="Symbol">→</a> <a id="5042" href="simple.html#4998" class="Bound">B</a><a id="5043" class="Symbol">}</a> <a id="5045" class="Symbol">→</a>
    <a id="5051" href="simple.html#5010" class="Bound">f</a> <a id="5053" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5055" href="simple.html#5012" class="Bound">h</a> <a id="5057" class="Symbol">→</a> <a id="5059" href="simple.html#5028" class="Bound">g</a> <a id="5061" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5063" href="simple.html#5030" class="Bound">i</a> <a id="5065" class="Symbol">→</a> <a id="5067" class="Symbol">(</a><a id="5068" href="simple.html#5010" class="Bound">f</a> <a id="5070" href="simple.html#4872" class="Function Operator">·</a> <a id="5072" href="simple.html#5028" class="Bound">g</a><a id="5073" class="Symbol">)</a> <a id="5075" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5077" class="Symbol">(</a><a id="5078" href="simple.html#5012" class="Bound">h</a> <a id="5080" href="simple.html#4872" class="Function Operator">·</a> <a id="5082" href="simple.html#5030" class="Bound">i</a><a id="5083" class="Symbol">)</a>
   <a id="5088" href="simple.html#4987" class="Function">rresp</a> <a id="5094" class="Symbol">{</a><a id="5095" href="simple.html#5095" class="Bound">A</a><a id="5096" class="Symbol">}</a> <a id="5098" class="Symbol">{</a><a id="5099" href="simple.html#5099" class="Bound">B</a><a id="5100" class="Symbol">}</a> <a id="5102" class="Symbol">{</a><a id="5103" href="simple.html#5103" class="Bound">C</a><a id="5104" class="Symbol">}</a> <a id="5106" class="Symbol">{</a><a id="5107" href="simple.html#5107" class="Bound">f</a><a id="5108" class="Symbol">}</a> <a id="5110" class="Symbol">{</a><a id="5111" href="simple.html#5111" class="Bound">h</a><a id="5112" class="Symbol">}</a> <a id="5114" class="Symbol">{</a><a id="5115" href="simple.html#5115" class="Bound">g</a><a id="5116" class="Symbol">}</a> <a id="5118" class="Symbol">{</a><a id="5119" href="simple.html#5119" class="Bound">i</a><a id="5120" class="Symbol">}</a> <a id="5122" href="simple.html#5122" class="Bound">x</a> <a id="5124" href="simple.html#5124" class="Bound">y</a> <a id="5126" class="Symbol">=</a>
    <a id="5132" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a> <a id="5138" class="Symbol">(</a><a id="5139" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="5144" class="Symbol">(λ</a> <a id="5147" href="simple.html#5147" class="Bound">t</a> <a id="5149" class="Symbol">→</a> <a id="5151" href="simple.html#5147" class="Bound">t</a> <a id="5153" href="simple.html#4872" class="Function Operator">·</a> <a id="5155" href="simple.html#5115" class="Bound">g</a><a id="5156" class="Symbol">)</a> <a id="5158" href="simple.html#5122" class="Bound">x</a><a id="5159" class="Symbol">)</a> <a id="5161" class="Symbol">(</a><a id="5162" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="5167" class="Symbol">(</a><a id="5168" href="simple.html#4872" class="Function Operator">_·_</a> <a id="5172" href="simple.html#5111" class="Bound">h</a><a id="5173" class="Symbol">)</a> <a id="5175" href="simple.html#5124" class="Bound">y</a><a id="5176" class="Symbol">)</a>
</pre>
<p>Now, here’s the proof that each fiber of a simple fibration is cartesian.</p>
It is moderately painful, because the record <code>CartesianCategory</code> has other records nested inside…
<pre class="Agda"><a id="fib-of-simple-cartesian"></a><a id="5361" href="simple.html#5361" class="Function">fib-of-simple-cartesian</a> <a id="5385" class="Symbol">:</a> <a id="5387" class="Symbol">∀</a> <a id="5389" class="Symbol">{</a><a id="5390" href="simple.html#5390" class="Bound">I</a> <a id="5392" class="Symbol">:</a> <a id="5394" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="5397" class="Symbol">}</a> <a id="5399" class="Symbol">→</a>
 <a id="5402" href="Categories.Category.Cartesian.Bundle.html#422" class="Record">CartesianCategory</a> <a id="5420" class="Symbol">(</a><a id="5421" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="5425" href="Agda.Primitive.html#764" class="Primitive">zero</a><a id="5429" class="Symbol">)</a> <a id="5431" href="Agda.Primitive.html#764" class="Primitive">zero</a> <a id="5436" href="Agda.Primitive.html#764" class="Primitive">zero</a>
<a id="5441" href="simple.html#5361" class="Function">fib-of-simple-cartesian</a> <a id="5465" class="Symbol">{</a><a id="5466" href="simple.html#5466" class="Bound">I</a><a id="5467" class="Symbol">}</a> <a id="5469" class="Symbol">=</a>
 <a id="5472" class="Keyword">record</a>
  <a id="5481" class="Symbol">{</a> <a id="5483" href="Categories.Category.Cartesian.Bundle.html#488" class="Field">U</a> <a id="5485" class="Symbol">=</a> <a id="5487" href="simple.html#4462" class="Function">fiber-of-simple</a> <a id="5503" class="Symbol">{</a><a id="5504" href="simple.html#5466" class="Bound">I</a><a id="5505" class="Symbol">}</a>
  <a id="5509" class="Symbol">;</a> <a id="5511" href="Categories.Category.Cartesian.Bundle.html#540" class="Field">cartesian</a> <a id="5521" class="Symbol">=</a>
    <a id="5527" class="Keyword">record</a>
     <a id="5539" class="Symbol">{</a> <a id="5541" href="Categories.Category.Cartesian.html#777" class="Field">terminal</a> <a id="5550" class="Symbol">=</a>
       <a id="5559" class="Keyword">record</a> <a id="5566" class="Symbol">{</a> <a id="5568" href="Categories.Object.Terminal.html#905" class="Field">⊤</a> <a id="5570" class="Symbol">=</a> <a id="5572" href="simple.html#1193" class="Datatype">t</a>
           <a id="5585" class="Symbol">;</a> <a id="5587" href="Categories.Object.Terminal.html#917" class="Field">⊤-is-terminal</a> <a id="5601" class="Symbol">=</a>
             <a id="5616" class="Keyword">record</a>
              <a id="5637" class="Symbol">{</a> <a id="5639" href="Categories.Object.Terminal.html#577" class="Field">!</a> <a id="5641" class="Symbol">=</a> <a id="5643" href="Function.Base.html#716" class="Function">const</a> <a id="5649" href="simple.html#1208" class="InductiveConstructor">⊤</a>
              <a id="5665" class="Symbol">;</a> <a id="5667" href="Categories.Object.Terminal.html#605" class="Field">!-unique</a> <a id="5676" class="Symbol">=</a>
                <a id="5694" class="Symbol">λ</a> <a id="5696" href="simple.html#5696" class="Bound">f</a> <a id="5698" class="Symbol">→</a> <a id="5700" href="simple.html#1329" class="Postulate">extensionality</a> <a id="5715" class="Symbol">(λ</a> <a id="5718" href="simple.html#5718" class="Bound">x</a> <a id="5720" class="Symbol">→</a> <a id="5722" href="simple.html#1215" class="Function">!-unique-lemma</a> <a id="5737" class="Symbol">(</a><a id="5738" href="simple.html#5696" class="Bound">f</a> <a id="5740" href="simple.html#5718" class="Bound">x</a><a id="5741" class="Symbol">))</a>
              <a id="5758" class="Symbol">}</a>
           <a id="5771" class="Symbol">}</a>
     <a id="5778" class="Symbol">;</a> <a id="5780" href="Categories.Category.Cartesian.html#801" class="Field">products</a> <a id="5789" class="Symbol">=</a>
       <a id="5798" class="Keyword">record</a>
        <a id="5813" class="Symbol">{</a> <a id="5815" href="Categories.Category.BinaryProducts.html#916" class="Field">product</a> <a id="5823" class="Symbol">=</a> <a id="5825" class="Symbol">λ</a> <a id="5827" class="Symbol">{</a><a id="5828" href="simple.html#5828" class="Bound">A</a><a id="5829" class="Symbol">}</a> <a id="5831" class="Symbol">{</a><a id="5832" href="simple.html#5832" class="Bound">B</a><a id="5833" class="Symbol">}</a> <a id="5835" class="Symbol">→</a>
          <a id="5847" class="Keyword">record</a>
           <a id="5865" class="Symbol">{</a> <a id="5867" href="Categories.Object.Product.Core.html#510" class="Field">A×B</a> <a id="5871" class="Symbol">=</a> <a id="5873" href="simple.html#5828" class="Bound">A</a> <a id="5875" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5877" href="simple.html#5832" class="Bound">B</a>
           <a id="5890" class="Symbol">;</a> <a id="5892" href="Categories.Object.Product.Core.html#526" class="Field">π₁</a> <a id="5895" class="Symbol">=</a> <a id="5897" class="Symbol">λ</a> <a id="5899" href="simple.html#5899" class="Bound">x</a> <a id="5901" class="Symbol">→</a> <a id="5903" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="5909" class="Symbol">(</a><a id="5910" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="5916" href="simple.html#5899" class="Bound">x</a><a id="5917" class="Symbol">)</a>
           <a id="5930" class="Symbol">;</a> <a id="5932" href="Categories.Object.Product.Core.html#546" class="Field">π₂</a> <a id="5935" class="Symbol">=</a> <a id="5937" class="Symbol">λ</a> <a id="5939" href="simple.html#5939" class="Bound">x</a> <a id="5941" class="Symbol">→</a> <a id="5943" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="5949" class="Symbol">(</a><a id="5950" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="5956" href="simple.html#5939" class="Bound">x</a><a id="5957" class="Symbol">)</a>
           <a id="5970" class="Symbol">;</a> <a id="5972" href="Categories.Object.Product.Core.html#566" class="Field Operator">⟨_,_⟩</a> <a id="5978" class="Symbol">=</a> <a id="5980" class="Symbol">λ</a> <a id="5982" href="simple.html#5982" class="Bound">f</a> <a id="5984" href="simple.html#5984" class="Bound">g</a> <a id="5986" href="simple.html#5986" class="Bound">t</a> <a id="5988" class="Symbol">→</a> <a id="5990" href="simple.html#5982" class="Bound">f</a> <a id="5992" href="simple.html#5986" class="Bound">t</a> <a id="5994" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5996" href="simple.html#5984" class="Bound">g</a> <a id="5998" href="simple.html#5986" class="Bound">t</a>
           <a id="6011" class="Symbol">;</a> <a id="6013" href="Categories.Object.Product.Core.html#603" class="Field">project₁</a> <a id="6022" class="Symbol">=</a> <a id="6024" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
           <a id="6040" class="Symbol">;</a> <a id="6042" href="Categories.Object.Product.Core.html#637" class="Field">project₂</a> <a id="6051" class="Symbol">=</a> <a id="6053" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
           <a id="6069" class="Symbol">;</a> <a id="6071" href="Categories.Object.Product.Core.html#671" class="Field">unique</a> <a id="6078" class="Symbol">=</a> <a id="6080" class="Symbol">λ</a> <a id="6082" class="Symbol">{</a><a id="6083" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="6088" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="6093" class="Symbol">→</a> <a id="6095" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="6099" class="Symbol">}</a>
           <a id="6112" class="Symbol">}</a> <a id="6114" class="Symbol">}</a> <a id="6116" class="Symbol">}</a> <a id="6118" class="Symbol">}</a>
</pre>
<p>but with a little help from our friend <code>λ {refl ... refl → refl}</code>, we did it!</p>
Mimicking the same argument, just not restricted to the fiber at <code>I</code>, one proves that the entire s(𝔹) is a cartesian category.
<pre class="Agda"><a id="simple-cartesian"></a><a id="6334" href="simple.html#6334" class="Function">simple-cartesian</a> <a id="6351" class="Symbol">:</a> <a id="6353" href="Categories.Category.Cartesian.Bundle.html#422" class="Record">CartesianCategory</a> <a id="6371" class="Symbol">(</a><a id="6372" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="6376" href="Agda.Primitive.html#764" class="Primitive">zero</a><a id="6380" class="Symbol">)</a> <a id="6382" href="Agda.Primitive.html#764" class="Primitive">zero</a> <a id="6387" href="Agda.Primitive.html#764" class="Primitive">zero</a>
<a id="6392" href="simple.html#6334" class="Function">simple-cartesian</a> <a id="6409" class="Symbol">=</a> <a id="6411" class="Keyword">record</a>
 <a id="6419" class="Symbol">{</a> <a id="6421" href="Categories.Category.Cartesian.Bundle.html#488" class="Field">U</a> <a id="6423" class="Symbol">=</a> <a id="6425" href="simple.html#3520" class="Function">simple</a>
 <a id="6433" class="Symbol">;</a> <a id="6435" href="Categories.Category.Cartesian.Bundle.html#540" class="Field">cartesian</a> <a id="6445" class="Symbol">=</a> <a id="6447" class="Keyword">record</a>
   <a id="6457" class="Symbol">{</a> <a id="6459" href="Categories.Category.Cartesian.html#777" class="Field">terminal</a> <a id="6468" class="Symbol">=</a> <a id="6470" class="Keyword">record</a>
    <a id="6481" class="Symbol">{</a> <a id="6483" href="Categories.Object.Terminal.html#905" class="Field">⊤</a> <a id="6485" class="Symbol">=</a> <a id="6487" href="simple.html#1193" class="Datatype">t</a> <a id="6489" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6491" href="simple.html#1193" class="Datatype">t</a>
    <a id="6497" class="Symbol">;</a> <a id="6499" href="Categories.Object.Terminal.html#917" class="Field">⊤-is-terminal</a> <a id="6513" class="Symbol">=</a>
      <a id="6521" class="Keyword">record</a> <a id="6528" class="Symbol">{</a> <a id="6530" href="Categories.Object.Terminal.html#577" class="Field">!</a> <a id="6532" class="Symbol">=</a> <a id="6534" href="Function.Base.html#716" class="Function">const</a> <a id="6540" href="simple.html#1208" class="InductiveConstructor">⊤</a> <a id="6542" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6544" href="Function.Base.html#716" class="Function">const</a> <a id="6550" href="simple.html#1208" class="InductiveConstructor">⊤</a>
             <a id="6565" class="Symbol">;</a> <a id="6567" href="Categories.Object.Terminal.html#605" class="Field">!-unique</a> <a id="6576" class="Symbol">=</a> <a id="6578" href="simple.html#6950" class="Function">bang-uniq</a>
             <a id="6601" class="Symbol">}</a> <a id="6603" class="Symbol">}</a>
   <a id="6608" class="Symbol">;</a> <a id="6610" href="Categories.Category.Cartesian.html#801" class="Field">products</a> <a id="6619" class="Symbol">=</a> <a id="6621" class="Keyword">record</a> <a id="6628" class="Symbol">{</a> <a id="6630" href="Categories.Category.BinaryProducts.html#916" class="Field">product</a> <a id="6638" class="Symbol">=</a> <a id="6640" class="Symbol">λ</a> <a id="6642" class="Symbol">{</a><a id="6643" href="simple.html#6643" class="Bound">A</a><a id="6644" class="Symbol">}</a> <a id="6646" class="Symbol">{</a><a id="6647" href="simple.html#6647" class="Bound">B</a><a id="6648" class="Symbol">}</a> <a id="6650" class="Symbol">→</a> <a id="6652" class="Keyword">record</a>
    <a id="6663" class="Symbol">{</a> <a id="6665" href="Categories.Object.Product.Core.html#510" class="Field">A×B</a> <a id="6669" class="Symbol">=</a> <a id="6671" class="Symbol">(</a><a id="6672" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="6678" href="simple.html#6643" class="Bound">A</a> <a id="6680" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6682" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="6688" href="simple.html#6647" class="Bound">B</a><a id="6689" class="Symbol">)</a> <a id="6691" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6693" class="Symbol">(</a><a id="6694" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="6700" href="simple.html#6643" class="Bound">A</a> <a id="6702" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6704" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="6710" href="simple.html#6647" class="Bound">B</a><a id="6711" class="Symbol">)</a>
    <a id="6717" class="Symbol">;</a> <a id="6719" href="Categories.Object.Product.Core.html#526" class="Field">π₁</a> <a id="6722" class="Symbol">=</a> <a id="6724" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="6730" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6732" class="Symbol">λ</a> <a id="6734" href="simple.html#6734" class="Bound">x</a> <a id="6736" class="Symbol">→</a> <a id="6738" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="6744" class="Symbol">(</a><a id="6745" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="6751" href="simple.html#6734" class="Bound">x</a><a id="6752" class="Symbol">)</a>
    <a id="6758" class="Symbol">;</a> <a id="6760" href="Categories.Object.Product.Core.html#546" class="Field">π₂</a> <a id="6763" class="Symbol">=</a> <a id="6765" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="6771" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6773" class="Symbol">(λ</a> <a id="6776" href="simple.html#6776" class="Bound">x</a> <a id="6778" class="Symbol">→</a> <a id="6780" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="6786" class="Symbol">(</a><a id="6787" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="6793" href="simple.html#6776" class="Bound">x</a><a id="6794" class="Symbol">))</a>
    <a id="6801" class="Symbol">;</a> <a id="6803" href="Categories.Object.Product.Core.html#566" class="Field Operator">⟨_,_⟩</a> <a id="6809" class="Symbol">=</a> <a id="6811" href="simple.html#7302" class="Function Operator">⟨_,_⟩</a>
    <a id="6821" class="Symbol">;</a> <a id="6823" href="Categories.Object.Product.Core.html#603" class="Field">project₁</a> <a id="6832" class="Symbol">=</a> <a id="6834" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="6843" class="Symbol">;</a> <a id="6845" href="Categories.Object.Product.Core.html#637" class="Field">project₂</a> <a id="6854" class="Symbol">=</a> <a id="6856" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="6865" class="Symbol">;</a> <a id="6867" href="Categories.Object.Product.Core.html#671" class="Field">unique</a> <a id="6874" class="Symbol">=</a> <a id="6876" class="Symbol">λ</a> <a id="6878" class="Symbol">{</a><a id="6879" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="6884" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="6889" class="Symbol">→</a> <a id="6891" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="6895" class="Symbol">}</a>
    <a id="6901" class="Symbol">}</a> <a id="6903" class="Symbol">}</a> <a id="6905" class="Symbol">}</a> <a id="6907" class="Symbol">}</a>
    <a id="6913" class="Keyword">where</a>
     <a id="6924" class="Keyword">open</a> <a id="6929" href="Categories.Category.Core.html#442" class="Module">Category</a> <a id="6938" href="simple.html#3520" class="Function">simple</a>
     <a id="6950" href="simple.html#6950" class="Function">bang-uniq</a> <a id="6960" class="Symbol">:</a>
      <a id="6968" class="Symbol">{</a><a id="6969" href="simple.html#6969" class="Bound">A</a> <a id="6971" class="Symbol">:</a> <a id="6973" href="Categories.Category.Core.html#559" class="Function">Obj</a><a id="6976" class="Symbol">}</a>
      <a id="6984" class="Comment">-------------------------</a>
      <a id="7016" class="Symbol">(</a><a id="7017" href="simple.html#7017" class="Bound">f</a> <a id="7019" class="Symbol">:</a> <a id="7021" href="simple.html#6969" class="Bound">A</a> <a id="7023" href="Categories.Category.Core.html#575" class="Function Operator">⇒</a> <a id="7025" class="Symbol">(</a><a id="7026" href="simple.html#1193" class="Datatype">t</a> <a id="7028" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7030" href="simple.html#1193" class="Datatype">t</a><a id="7031" class="Symbol">))</a> <a id="7034" class="Symbol">→</a>
      <a id="7042" class="Comment">--------------------------------------</a>
      <a id="7087" class="Symbol">(</a><a id="7088" href="simple.html#3520" class="Function">simple</a> <a id="7095" href="Categories.Category.Core.html#595" class="Field Operator">Category.≈</a> <a id="7106" class="Symbol">(</a><a id="7107" href="Function.Base.html#716" class="Function">const</a> <a id="7113" href="simple.html#1208" class="InductiveConstructor">⊤</a> <a id="7115" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7117" href="Function.Base.html#716" class="Function">const</a> <a id="7123" href="simple.html#1208" class="InductiveConstructor">⊤</a><a id="7124" class="Symbol">))</a> <a id="7127" href="simple.html#7017" class="Bound">f</a>
     <a id="7134" href="simple.html#6950" class="Function">bang-uniq</a> <a id="7144" class="Symbol">{</a><a id="7145" href="simple.html#7145" class="Bound">I</a> <a id="7147" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7149" href="simple.html#7149" class="Bound">X</a><a id="7150" class="Symbol">}</a> <a id="7152" class="Symbol">(</a><a id="7153" href="simple.html#7153" class="Bound">u</a> <a id="7155" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7157" href="simple.html#7157" class="Bound">k</a><a id="7158" class="Symbol">)</a> <a id="7160" class="Symbol">=</a>
      <a id="7168" href="Relation.Binary.PropositionalEquality.Core.html#1367" class="Function">cong₂</a> <a id="7174" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">Data.Product._,_</a>
       <a id="7198" class="Symbol">(</a><a id="7199" href="simple.html#1329" class="Postulate">extensionality</a> <a id="7214" class="Symbol">(λ</a> <a id="7217" href="simple.html#7217" class="Bound">x</a> <a id="7219" class="Symbol">→</a> <a id="7221" href="simple.html#1215" class="Function">!-unique-lemma</a> <a id="7236" class="Symbol">(</a><a id="7237" href="simple.html#7153" class="Bound">u</a> <a id="7239" href="simple.html#7217" class="Bound">x</a><a id="7240" class="Symbol">)))</a>
       <a id="7251" class="Symbol">(</a><a id="7252" href="simple.html#1329" class="Postulate">extensionality</a> <a id="7267" class="Symbol">(λ</a> <a id="7270" href="simple.html#7270" class="Bound">x</a> <a id="7272" class="Symbol">→</a> <a id="7274" href="simple.html#1215" class="Function">!-unique-lemma</a> <a id="7289" class="Symbol">(</a><a id="7290" href="simple.html#7157" class="Bound">k</a> <a id="7292" href="simple.html#7270" class="Bound">x</a><a id="7293" class="Symbol">)))</a>
     <a id="7302" href="simple.html#7302" class="Function Operator">⟨_,_⟩</a> <a id="7308" class="Symbol">:</a>
      <a id="7316" class="Symbol">{</a><a id="7317" href="simple.html#7317" class="Bound">A</a> <a id="7319" href="simple.html#7319" class="Bound">B</a> <a id="7321" href="simple.html#7321" class="Bound">C</a> <a id="7323" class="Symbol">:</a> <a id="7325" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="7329" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="7331" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="7334" class="Symbol">}</a> <a id="7336" class="Symbol">→</a>
      <a id="7344" href="simple.html#7321" class="Bound">C</a> <a id="7346" href="Categories.Category.Core.html#575" class="Function Operator">⇒</a> <a id="7348" href="simple.html#7317" class="Bound">A</a> <a id="7350" class="Symbol">→</a>
      <a id="7358" href="simple.html#7321" class="Bound">C</a> <a id="7360" href="Categories.Category.Core.html#575" class="Function Operator">⇒</a> <a id="7362" href="simple.html#7319" class="Bound">B</a> <a id="7364" class="Symbol">→</a>
      <a id="7372" href="simple.html#7321" class="Bound">C</a> <a id="7374" href="Categories.Category.Core.html#575" class="Function Operator">⇒</a> <a id="7376" class="Symbol">((</a><a id="7378" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="7384" href="simple.html#7317" class="Bound">A</a> <a id="7386" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="7388" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="7394" href="simple.html#7319" class="Bound">B</a><a id="7395" class="Symbol">)</a> <a id="7397" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7399" class="Symbol">(</a><a id="7400" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="7406" href="simple.html#7317" class="Bound">A</a> <a id="7408" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="7410" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="7416" href="simple.html#7319" class="Bound">B</a><a id="7417" class="Symbol">))</a>
     <a id="7425" href="simple.html#7302" class="Function Operator">⟨_,_⟩</a> <a id="7431" class="Symbol">{</a><a id="7432" href="simple.html#7432" class="Bound">A0</a> <a id="7435" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7437" href="simple.html#7437" class="Bound">A1</a><a id="7439" class="Symbol">}</a> <a id="7441" class="Symbol">{</a><a id="7442" href="simple.html#7442" class="Bound">B0</a> <a id="7445" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7447" href="simple.html#7447" class="Bound">B1</a><a id="7449" class="Symbol">}</a> <a id="7451" class="Symbol">{</a><a id="7452" href="simple.html#7452" class="Bound">C0</a> <a id="7455" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7457" href="simple.html#7457" class="Bound">C1</a><a id="7459" class="Symbol">}</a> <a id="7461" class="Symbol">(</a><a id="7462" href="simple.html#7462" class="Bound">u</a> <a id="7464" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7466" href="simple.html#7466" class="Bound">h</a><a id="7467" class="Symbol">)</a> <a id="7469" class="Symbol">(</a><a id="7470" href="simple.html#7470" class="Bound">v</a> <a id="7472" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7474" href="simple.html#7474" class="Bound">k</a><a id="7475" class="Symbol">)</a> <a id="7477" class="Symbol">=</a>
      <a id="7485" class="Symbol">(λ</a> <a id="7488" href="simple.html#7488" class="Bound">x</a> <a id="7490" class="Symbol">→</a> <a id="7492" class="Symbol">(</a><a id="7493" href="simple.html#7462" class="Bound">u</a> <a id="7495" href="simple.html#7488" class="Bound">x</a><a id="7496" class="Symbol">)</a> <a id="7498" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7500" class="Symbol">(</a><a id="7501" href="simple.html#7470" class="Bound">v</a> <a id="7503" href="simple.html#7488" class="Bound">x</a><a id="7504" class="Symbol">))</a> <a id="7507" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7509" class="Symbol">λ</a> <a id="7511" href="simple.html#7511" class="Bound">x</a> <a id="7513" class="Symbol">→</a> <a id="7515" class="Symbol">(</a><a id="7516" href="simple.html#7466" class="Bound">h</a> <a id="7518" href="simple.html#7511" class="Bound">x</a><a id="7519" class="Symbol">)</a> <a id="7521" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7523" class="Symbol">(</a><a id="7524" href="simple.html#7474" class="Bound">k</a> <a id="7526" href="simple.html#7511" class="Bound">x</a><a id="7527" class="Symbol">)</a>
</pre>
<p>…the biggest pain was to indent the code in a logical way.</p>
And now for the proof that each fiber of <code>U : s(𝔹) → 𝔹</code> is cartesian closed:
<pre class="Agda"><a id="fib-of-simple-ccc"></a><a id="7676" href="simple.html#7676" class="Function">fib-of-simple-ccc</a> <a id="7694" class="Symbol">:</a> <a id="7696" class="Symbol">{</a><a id="7697" href="simple.html#7697" class="Bound">I</a> <a id="7699" class="Symbol">:</a> <a id="7701" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="7704" class="Symbol">}</a> <a id="7706" class="Symbol">→</a> <a id="7708" href="Categories.Category.CartesianClosed.Canonical.html#1539" class="Record">CartesianClosed</a> <a id="7724" class="Symbol">(</a><a id="7725" href="simple.html#4462" class="Function">fiber-of-simple</a> <a id="7741" class="Symbol">{</a><a id="7742" href="simple.html#7697" class="Bound">I</a><a id="7743" class="Symbol">})</a>
<a id="7746" href="simple.html#7676" class="Function">fib-of-simple-ccc</a> <a id="7764" class="Symbol">{</a><a id="7765" href="simple.html#7765" class="Bound">I</a><a id="7766" class="Symbol">}</a> <a id="7768" class="Symbol">=</a>
 <a id="7771" class="Keyword">record</a>
  <a id="7780" class="Symbol">{</a> <a id="7782" href="Categories.Category.CartesianClosed.Canonical.html#1671" class="Field">⊤</a> <a id="7784" class="Symbol">=</a> <a id="7786" href="simple.html#1193" class="Datatype">t</a>
  <a id="7790" class="Symbol">;</a> <a id="7792" href="Categories.Category.CartesianClosed.Canonical.html#1686" class="Field Operator">_×_</a> <a id="7796" class="Symbol">=</a> <a id="7798" href="Data.Product.html#1167" class="Function Operator">_×_</a>
  <a id="7804" class="Symbol">;</a> <a id="7806" href="Categories.Category.CartesianClosed.Canonical.html#1714" class="Field">!</a> <a id="7808" class="Symbol">=</a> <a id="7810" class="Symbol">λ</a> <a id="7812" href="simple.html#7812" class="Bound">x</a> <a id="7814" class="Symbol">→</a> <a id="7816" href="simple.html#1208" class="InductiveConstructor">⊤</a>
  <a id="7820" class="Symbol">;</a> <a id="7822" href="Categories.Category.CartesianClosed.Canonical.html#1732" class="Field">π₁</a> <a id="7825" class="Symbol">=</a> <a id="7827" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="7833" href="simple.html#872" class="Function Operator">⋆</a> <a id="7835" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a>
  <a id="7843" class="Symbol">;</a> <a id="7845" href="Categories.Category.CartesianClosed.Canonical.html#1754" class="Field">π₂</a> <a id="7848" class="Symbol">=</a> <a id="7850" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="7856" href="simple.html#872" class="Function Operator">⋆</a> <a id="7858" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a>
  <a id="7866" class="Symbol">;</a> <a id="7868" href="Categories.Category.CartesianClosed.Canonical.html#1776" class="Field Operator">⟨_,_⟩</a> <a id="7874" class="Symbol">=</a> <a id="7876" class="Symbol">λ</a> <a id="7878" href="simple.html#7878" class="Bound">f</a> <a id="7880" href="simple.html#7880" class="Bound">g</a> <a id="7882" href="simple.html#7882" class="Bound">ci</a> <a id="7885" class="Symbol">→</a> <a id="7887" class="Symbol">(</a><a id="7888" href="simple.html#7878" class="Bound">f</a> <a id="7890" href="simple.html#7882" class="Bound">ci</a><a id="7892" class="Symbol">)</a> <a id="7894" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7896" class="Symbol">(</a><a id="7897" href="simple.html#7880" class="Bound">g</a> <a id="7899" href="simple.html#7882" class="Bound">ci</a><a id="7901" class="Symbol">)</a>
  <a id="7905" class="Symbol">;</a> <a id="7907" href="Categories.Category.CartesianClosed.Canonical.html#1815" class="Field">!-unique</a> <a id="7916" class="Symbol">=</a> <a id="7918" class="Symbol">λ</a> <a id="7920" href="simple.html#7920" class="Bound">f</a> <a id="7922" class="Symbol">→</a> <a id="7924" href="simple.html#1329" class="Postulate">extensionality</a> <a id="7939" class="Symbol">λ</a> <a id="7941" href="simple.html#7941" class="Bound">x</a> <a id="7943" class="Symbol">→</a> <a id="7945" href="simple.html#1215" class="Function">!-unique-lemma</a> <a id="7960" class="Symbol">(</a><a id="7961" href="simple.html#7920" class="Bound">f</a> <a id="7963" href="simple.html#7941" class="Bound">x</a><a id="7964" class="Symbol">)</a>
  <a id="7968" class="Symbol">;</a> <a id="7970" href="Categories.Category.CartesianClosed.Canonical.html#1851" class="Field">π₁-comp</a> <a id="7978" class="Symbol">=</a> <a id="7980" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="7987" class="Symbol">;</a> <a id="7989" href="Categories.Category.CartesianClosed.Canonical.html#1885" class="Field">π₂-comp</a> <a id="7997" class="Symbol">=</a> <a id="7999" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="8006" class="Symbol">;</a> <a id="8008" href="Categories.Category.CartesianClosed.Canonical.html#1920" class="Field">⟨,⟩-unique</a> <a id="8019" class="Symbol">=</a> <a id="8021" class="Symbol">λ</a> <a id="8023" class="Symbol">{</a><a id="8024" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="8029" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="8034" class="Symbol">→</a> <a id="8036" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="8040" class="Symbol">}</a>
  <a id="8044" class="Symbol">;</a> <a id="8046" href="Categories.Category.CartesianClosed.Canonical.html#2601" class="Field Operator">_^_</a> <a id="8050" class="Symbol">=</a> <a id="8052" class="Symbol">λ</a> <a id="8054" href="simple.html#8054" class="Bound">A</a> <a id="8056" href="simple.html#8056" class="Bound">B</a> <a id="8058" class="Symbol">→</a> <a id="8060" href="simple.html#8056" class="Bound">B</a> <a id="8062" class="Symbol">→</a> <a id="8064" href="simple.html#8054" class="Bound">A</a>
  <a id="8068" class="Symbol">;</a> <a id="8070" href="Categories.Category.CartesianClosed.Canonical.html#2629" class="Field">eval</a> <a id="8075" class="Symbol">=</a> <a id="8077" href="simple.html#8282" class="Function">evev</a>
  <a id="8084" class="Symbol">;</a> <a id="8086" href="Categories.Category.CartesianClosed.Canonical.html#2655" class="Field">curry</a> <a id="8092" class="Symbol">=</a> <a id="8094" class="Symbol">λ</a> <a id="8096" href="simple.html#8096" class="Bound">f</a> <a id="8098" href="simple.html#8098" class="Bound">ci</a> <a id="8101" href="simple.html#8101" class="Bound">a</a> <a id="8103" class="Symbol">→</a> <a id="8105" href="simple.html#8096" class="Bound">f</a> <a id="8107" class="Symbol">(((</a><a id="8110" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="8116" href="simple.html#8098" class="Bound">ci</a><a id="8118" class="Symbol">)</a> <a id="8120" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8122" href="simple.html#8101" class="Bound">a</a><a id="8123" class="Symbol">)</a> <a id="8125" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8127" class="Symbol">(</a><a id="8128" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="8134" href="simple.html#8098" class="Bound">ci</a><a id="8136" class="Symbol">))</a>
  <a id="8141" class="Symbol">;</a> <a id="8143" href="Categories.Category.CartesianClosed.Canonical.html#2690" class="Field">eval-comp</a> <a id="8153" class="Symbol">=</a> <a id="8155" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="8162" class="Symbol">;</a> <a id="8164" href="Categories.Category.CartesianClosed.Canonical.html#2734" class="Field">curry-resp-≈</a> <a id="8177" class="Symbol">=</a> <a id="8179" class="Symbol">λ</a> <a id="8181" class="Symbol">{</a><a id="8182" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="8187" class="Symbol">→</a> <a id="8189" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="8193" class="Symbol">}</a>
  <a id="8197" class="Symbol">;</a> <a id="8199" href="Categories.Category.CartesianClosed.Canonical.html#2779" class="Field">curry-unique</a> <a id="8212" class="Symbol">=</a> <a id="8214" class="Symbol">λ</a> <a id="8216" class="Symbol">{</a><a id="8217" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="8222" class="Symbol">→</a> <a id="8224" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="8228" class="Symbol">}</a>
  <a id="8232" class="Symbol">}</a>
  <a id="8236" class="Keyword">where</a>
  <a id="8244" class="Keyword">open</a> <a id="8249" href="Categories.Category.Core.html#442" class="Module">Category</a> <a id="8258" class="Symbol">(</a><a id="8259" href="simple.html#4462" class="Function">fiber-of-simple</a> <a id="8275" class="Symbol">{</a><a id="8276" href="simple.html#7765" class="Bound">I</a><a id="8277" class="Symbol">})</a>
  <a id="8282" href="simple.html#8282" class="Function">evev</a> <a id="8287" class="Symbol">:</a> <a id="8289" class="Symbol">{</a><a id="8290" href="simple.html#8290" class="Bound">B</a> <a id="8292" href="simple.html#8292" class="Bound">A</a> <a id="8294" class="Symbol">:</a> <a id="8296" href="Categories.Category.Core.html#559" class="Function">Obj</a><a id="8299" class="Symbol">}</a> <a id="8301" class="Symbol">→</a> <a id="8303" class="Symbol">((</a><a id="8305" href="simple.html#8292" class="Bound">A</a> <a id="8307" class="Symbol">→</a> <a id="8309" href="simple.html#8290" class="Bound">B</a><a id="8310" class="Symbol">)</a> <a id="8312" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="8314" href="simple.html#8292" class="Bound">A</a><a id="8315" class="Symbol">)</a> <a id="8317" href="Categories.Category.Core.html#575" class="Function Operator">⇒</a> <a id="8319" href="simple.html#8290" class="Bound">B</a>
  <a id="8323" href="simple.html#8282" class="Function">evev</a> <a id="8328" class="Symbol">((</a><a id="8330" href="simple.html#8330" class="Bound">f</a> <a id="8332" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8334" href="simple.html#8334" class="Bound">a</a><a id="8335" class="Symbol">)</a> <a id="8337" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8339" href="simple.html#8339" class="Bound">i</a><a id="8340" class="Symbol">)</a> <a id="8342" class="Symbol">=</a> <a id="8344" href="simple.html#8330" class="Bound">f</a> <a id="8346" href="simple.html#8334" class="Bound">a</a>
</pre>
